rng(20, 'twister')
% n = 8;
% m = 5;
n = 14;
m = 8;
% ss = rss(n, n, m);
% A0 = eye(n)*1-ones(n)*0.2;
[imat, jmat] = meshgrid(1:n, 1:n);

A0 = (1/n)*min(imat./jmat, jmat./imat) + 0.4*eye(n);

% A0 = -0.8*eye(n) + ones(n)*0.1;
% A0 = 1./gallery('minij',n);
% A0(3, 2) = 2;
B0 = eye(n, m);
% A0 = eye(3);
% B0 = [0 0 ; 1 0; 0 1];
ss = struct('A', A0, 'B', B0);

rho = 0.8;

% out = ESS_quantized_sign([], rho, ss);
% out = ESS_quantized_clean_aff(rho, ss);
out = SS_quantized_clean_aff(rho, ss);


%% recovery
if ~out.problem

    Acl_out = ss.A + ss.B * out.K;
    eig(Acl_out)
else
    eig(A0)
end
%% simulate a trajectory
 